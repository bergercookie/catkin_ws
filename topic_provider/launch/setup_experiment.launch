<?xml version="1.0"?>

<!--
Mon Sep 26 21:29:42 EEST 2016, Nikos Koukis

Launchfile is used for starting up all the necessary nodes in order to drive
around a robot either pioneer-3dx or pioneer-2at and record its odometry
measurements and measurements of a mounted hokuyo laser scanner.

The following situation is assumed:
- Hokuyo laser is mounted and is available vai a /dev device.
- An arduino is used for controlling the motors of the wheel motors.
Communication with the arduino is achived via a /dev device.

-->
<launch>

	<!-- LAUNCH ARGUMENTS -->
	<!-- ************************************* -->

	<!-- Hokuyo Laser Scanner -->
	<arg
		name="hokuyo_port"
		default="/dev/ttyACM2"
		>
	</arg>
	<arg
		name="scan_topic"
		default="/scan"
		>
	</arg>

	<!-- TODO - Delete this? -->
	<!-- Rosbag Recordings-->
	<arg
		name="rosbag_dir"
		default="bags"
		>
	</arg>

	<!-- Arduino configuration -->
	<arg
		name="arduino_port"
		default="/dev/ttyACM1"
		>
	</arg>

	<!-- Joystick configuration -->
	<arg
		name="joystick_port"
		default="/dev/input/js0"
		>
	</arg>

	<!-- Miscellaneous args -->
	<arg
		name="output"
		default="screen"
		>
	</arg>
	<arg
		name="robot_model"
		default="2at"
		>
	</arg>

  <!-- LAUNCH PARAMETERS -->
	<!-- ************************************* -->

	<!-- Hokuyo Laser Scanner -->
	<param
		name="/hokuyo_node/port"
		value="$(arg hokuyo_port)"
		>
	</param>

	<!-- Joystick configuration -->
	<param
		name="joy_node/dev"
		value="$(arg joystick_port)"
		>
	</param>

	<!-- Arduino configuration -->
	<param
		name="arduino/port"
		value="$(arg arduino_port)"
		>
	</param>


	<!-- NODES TO BE LAUNCHED -->
	<!-- ************************************* -->

	<!-- Hokuyo Laser Scanner -->
	<node
		pkg="hokuyo_node"
		type="hokuyo_node"
		name="hokuyo_node"
		args="/scan:=$(arg scan_topic)"
		>
	</node>

	<!-- Arduino configuration -->
	<node
		pkg="arduino_mr"
		type="pioneer_$(arg robot_model).py"
		name="pioneer_$(arg robot_model)"
		output="$(arg output)"
		>
	</node>

	<!-- Joystick configuration -->
	<node
		pkg="joy"
		type="joy_node"
		name="joy_node"
		output="$(arg output)"
		>
	</node>
	<node
		pkg="joy_to_arduino"
		type="teleop_MR_2at"
		name="teleop_MR_2at"
		output="$(arg output)"
		>
	</node>

	<!-- Rosbag Recordings-->
	<node
		pkg="rosbag"
		type="record"
		name="rosbag_recorder"
		args="--all -O records.bag"
		output="$(arg output)"
		>
	</node>

</launch>
